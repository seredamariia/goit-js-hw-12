{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from 'axios';\n\nlet gallery = new SimpleLightbox('.gallery-item a', {\n  captionDelay: 250,\n  captionsData: 'alt',\n});\n\nconst cardContainer = document.querySelector('.gallery');\nconst searchForm = document.querySelector('.search-form');\nconst loadMore = document.querySelector('.load-btn');\nconst loader = document.querySelector('.loader');\n\naxios.defaults.baseURL = 'https://pixabay.com/api';\nconst API_KEY = '42139525-c14302dd397ed074e72a8f596';\n\nlet page = 1;\nlet query = '';\nlet maxPage = 0;\n\nsearchForm.addEventListener('submit', onSearch);\n\nasync function onSearch(event) {\n  event.preventDefault();\n  cardContainer.innerHTML = '';\n  page = 1;\n  loadMore.classList.add('is-hidden');\n\n  const query = event.currentTarget.elements.query.value.trim();\n  if (!query) {\n    handleNoImages();\n    return;\n  }\n\n  try {\n    const { hits, total } = await getImages(query);\n    loader.style.display = 'none';\n    maxPage = Math.ceil(total / 15);\n\n    if (hits.length === 0) {\n      loadMore.classList.add('is-hidden');\n      handleNoImages();\n    } else {\n      createMarkup(hits);\n      loadMore.classList.remove('is-hidden');\n      loadMore.addEventListener('click', onLoadMore);\n    }\n  } catch {\n    error => console.error(error);\n  } finally {\n    searchForm.reset();\n    if (page === maxPage) {\n      loadMore.classList.add('is-hidden');\n      iziToast.error({\n        maxWidth: 432,\n        position: 'topRight',\n        color: 'red',\n        message: \"We're sorry, but you've reached the end of search results!\",\n      });\n    }\n  }\n}\n\nasync function getImages(query, page) {\n  loader.style.display = 'block';\n  return axios\n    .get('/', {\n      params: {\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: 15,\n        page,\n      },\n    })\n    .then(({ data }) => data);\n}\n\nasync function onLoadMore() {\n  page += 1;\n  try {\n    loadMore.classList.add('is-hidden');\n    const { hits } = await getImages(query, page);\n    loader.style.display = 'none';\n    createMarkup(hits);\n    scrollImg();\n    loadMore.classList.remove('is-hidden');\n  } catch (error) {\n    console.log(error);\n  } finally {\n    if (page === maxPage) {\n      loadMore.classList.add('is-hidden');\n      iziToast.error({\n        maxWidth: 432,\n        position: 'topRight',\n        color: 'red',\n        message: \"We're sorry, but you've reached the end of search results!\",\n      });\n    }\n  }\n}\n\nfunction createMarkup(hits) {\n  const markup = hits\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<li class=\"gallery-item\">\n            <a href=${largeImageURL}> \n                <img class=\"gallery-image\" src=${webformatURL} alt=${tags} />\n            </a>\n            <div class=\"gallery-text\">\n                <p class=\"text-block\">Likes: <span class=\"text-value\">${likes}</span></p>\n                <p class=\"text-block\">Views: <span class=\"text-value\">${views}</span></p>\n                <p class=\"text-block\">Comments: <span class=\"text-value\">${comments}</span></p>\n                <p class=\"text-block\">Downloads: <span class=\"text-value\">${downloads}</span></p>\n            </div>\n      </li>`\n    )\n    .join('');\n\n  cardContainer.insertAdjacentHTML('beforeend', markup);\n  gallery.refresh();\n}\n\nfunction scrollImg() {\n  const rect = document.querySelector('.gallery-item').getBoundingClientRect();\n  window.scrollBy({ top: rect.height * 2, left: 0, behavior: 'smooth' });\n}\n\nfunction handleNoImages() {\n  iziToast.error({\n    maxWidth: 432,\n    position: 'topRight',\n    color: 'red',\n    message:\n      'Sorry, there are no images matching your search query. Please try again!',\n  });\n  loader.style.display = 'none';\n}\n"],"names":["gallery","SimpleLightbox","cardContainer","searchForm","loadMore","loader","axios","API_KEY","page","query","maxPage","onSearch","event","handleNoImages","hits","total","getImages","createMarkup","onLoadMore","iziToast","data","scrollImg","error","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","rect"],"mappings":"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"}